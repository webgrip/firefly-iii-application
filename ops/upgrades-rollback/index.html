
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Version upgrade procedures, rollback strategies, and validation steps.">
      
      
        <meta name="author" content="<Infrastructure/Platform Team>">
      
      
        <link rel="canonical" href="https://webgrip.github.io/firefly-iii-application/ops/upgrades-rollback/">
      
      
        <link rel="prev" href="../observability/">
      
      
        <link rel="next" href="../troubleshooting/startup/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>Upgrades & Rollback - firefly-iii-application TechDocs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#upgrade-strategy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="firefly-iii-application TechDocs" class="md-header__button md-logo" aria-label="firefly-iii-application TechDocs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            firefly-iii-application TechDocs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Upgrades & Rollback
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../home/" class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../app/overview/" class="md-tabs__link">
          
  
  Application

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../domain/ubiquitous-language/" class="md-tabs__link">
          
  
  Domain (DDD)

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../runbook/" class="md-tabs__link">
          
  
  Operations

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../template-sync/" class="md-tabs__link">
        
  
    
  
  Template Sync

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="firefly-iii-application TechDocs" class="md-nav__button md-logo" aria-label="firefly-iii-application TechDocs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    firefly-iii-application TechDocs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../home/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 21.5c-1.35-.85-3.8-1.5-5.5-1.5-1.65 0-3.35.3-4.75 1.05-.1.05-.15.05-.25.05-.25 0-.5-.25-.5-.5V6c.6-.45 1.25-.75 2-1 1.11-.35 2.33-.5 3.5-.5 1.95 0 4.05.4 5.5 1.5 1.45-1.1 3.55-1.5 5.5-1.5 1.17 0 2.39.15 3.5.5.75.25 1.4.55 2 1v14.6c0 .25-.25.5-.5.5-.1 0-.15 0-.25-.05-1.4-.75-3.1-1.05-4.75-1.05-1.7 0-4.15.65-5.5 1.5M12 8v11.5c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5V7c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5m1 3.5c1.11-.68 2.6-1 4.5-1 .91 0 1.76.09 2.5.28V9.23c-.87-.15-1.71-.23-2.5-.23q-2.655 0-4.5.84zm4.5.17c-1.71 0-3.21.26-4.5.79v1.69c1.11-.65 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24v-1.5c-.87-.16-1.71-.23-2.5-.23m2.5 2.9c-.87-.16-1.71-.24-2.5-.24-1.83 0-3.33.27-4.5.8v1.69c1.11-.66 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24z"/></svg>
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../app/overview/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Application
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../domain/ubiquitous-language/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Domain (DDD)
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Operations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runbook/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 9H7V7h10m0 6H7v-2h10m-3 6H7v-2h7M12 3a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m7 0h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2"/></svg>
  
  <span class="md-ellipsis">
    Runbook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../networking/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 3a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-4v2h1a1 1 0 0 1 1 1h7v2h-7a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1H2v-2h7a1 1 0 0 1 1-1h1v-2H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"/></svg>
  
  <span class="md-ellipsis">
    Networking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m16 11.78 4.24-7.33 1.73 1-5.23 9.05-6.51-3.75L5.46 19H22v2H2V3h2v14.54L9.5 8z"/></svg>
  
  <span class="md-ellipsis">
    Observability
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 10.12h-6.78l2.74-2.82c-2.73-2.7-7.15-2.8-9.88-.1a6.887 6.887 0 0 0 0 9.8c2.73 2.7 7.15 2.7 9.88 0 1.36-1.35 2.04-2.92 2.04-4.9h2c0 1.98-.88 4.55-2.64 6.29-3.51 3.48-9.21 3.48-12.72 0-3.5-3.47-3.53-9.11-.02-12.58a8.987 8.987 0 0 1 12.65 0L21 3zM12.5 8v4.25l3.5 2.08-.72 1.21L11 13V8z"/></svg>
  
  <span class="md-ellipsis">
    Upgrades & Rollback
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 10.12h-6.78l2.74-2.82c-2.73-2.7-7.15-2.8-9.88-.1a6.887 6.887 0 0 0 0 9.8c2.73 2.7 7.15 2.7 9.88 0 1.36-1.35 2.04-2.92 2.04-4.9h2c0 1.98-.88 4.55-2.64 6.29-3.51 3.48-9.21 3.48-12.72 0-3.5-3.47-3.53-9.11-.02-12.58a8.987 8.987 0 0 1 12.65 0L21 3zM12.5 8v4.25l3.5 2.08-.72 1.21L11 13V8z"/></svg>
  
  <span class="md-ellipsis">
    Upgrades & Rollback
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#upgrade-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Upgrade Strategy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-upgrade-preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Pre-Upgrade Preparation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upgrade-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Upgrade Execution
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rollback-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      Rollback Procedures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validation-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Validation &amp; Testing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upgrade-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      Upgrade Checklist
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#emergency-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      Emergency Procedures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sources" class="md-nav__link">
    <span class="md-ellipsis">
      Sources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../troubleshooting/startup/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../template-sync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Template Sync
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Upgrades & Rollback</h1>

<p><strong>Purpose:</strong> Ensure safe and reliable version management.</p>
<p><strong>Contents</strong>
- <a href="#upgrade-strategy">Upgrade Strategy</a>
- <a href="#pre-upgrade-preparation">Pre-Upgrade Preparation</a>
- <a href="#upgrade-execution">Upgrade Execution</a>
- <a href="#rollback-procedures">Rollback Procedures</a>
- <a href="#validation--testing">Validation &amp; Testing</a>
- <a href="#sources">Sources</a></p>
<h2 id="upgrade-strategy">Upgrade Strategy<a class="headerlink" href="#upgrade-strategy" title="Permanent link">&para;</a></h2>
<p><strong>Tagging Policy:</strong>
- <strong>Production</strong>: Use specific version tags (e.g., <code>6.1.17</code>, <code>6.1.18</code>)
- <strong>Staging</strong>: Use release candidate tags (e.g., <code>6.1.18-rc1</code>)
- <strong>Development</strong>: Use specific commits or feature branches
- <strong>Never</strong>: Use <code>latest</code> tag in any environment</p>
<p><strong>Version Support Matrix:</strong></p>
<table>
<thead>
<tr>
<th>Environment</th>
<th>Upgrade Frequency</th>
<th>Version Lag</th>
<th>Approval Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>Development</td>
<td>Immediate</td>
<td>Latest RC</td>
<td>Developer</td>
</tr>
<tr>
<td>Staging</td>
<td>Weekly</td>
<td>1-2 versions behind latest</td>
<td>Team Lead</td>
</tr>
<tr>
<td>Production</td>
<td>Monthly</td>
<td>2-4 versions behind latest</td>
<td>Change Board</td>
</tr>
</tbody>
</table>
<p><strong>Upgrade Types:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Example</th>
<th>Database Changes</th>
<th>Downtime</th>
<th>Risk Level</th>
</tr>
</thead>
<tbody>
<tr>
<td>Patch</td>
<td>6.1.17 → 6.1.18</td>
<td>Rare</td>
<td>None</td>
<td>Low</td>
</tr>
<tr>
<td>Minor</td>
<td>6.1.x → 6.2.0</td>
<td>Possible</td>
<td>Minimal</td>
<td>Medium</td>
</tr>
<tr>
<td>Major</td>
<td>6.x → 7.0</td>
<td>Likely</td>
<td>Planned</td>
<td>High</td>
</tr>
</tbody>
</table>
<h2 id="pre-upgrade-preparation">Pre-Upgrade Preparation<a class="headerlink" href="#pre-upgrade-preparation" title="Permanent link">&para;</a></h2>
<p><strong>Backup Verification:</strong>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Create pre-upgrade backup</span>
<span class="nv">DATE</span><span class="o">=</span><span class="k">$(</span>date<span class="w"> </span>+%Y%m%d_%H%M%S<span class="k">)</span>
<span class="nv">BACKUP_DIR</span><span class="o">=</span><span class="s2">&quot;/backups/pre-upgrade-</span><span class="si">${</span><span class="nv">DATE</span><span class="si">}</span><span class="s2">&quot;</span>
mkdir<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BACKUP_DIR</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># Database backup</span>
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>firefly-iii-application.mariadb<span class="w"> </span>mysqldump<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-u<span class="w"> </span>application<span class="w"> </span>-p<span class="s1">&#39;${DB_PASSWORD}&#39;</span><span class="w"> </span>application<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BACKUP_DIR</span><span class="si">}</span><span class="s2">/database.sql&quot;</span>

<span class="c1"># Storage backup</span>
docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>firefly-iii-application-application-storage-data:/source:ro<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BACKUP_DIR</span><span class="si">}</span><span class="s2">&quot;</span>:/backup<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>alpine:latest<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>tar<span class="w"> </span>czf<span class="w"> </span>/backup/storage.tar.gz<span class="w"> </span>-C<span class="w"> </span>/source<span class="w"> </span>.

<span class="c1"># Configuration backup</span>
cp<span class="w"> </span>.env<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BACKUP_DIR</span><span class="si">}</span><span class="s2">/env.backup&quot;</span>
cp<span class="w"> </span>docker-compose.yml<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BACKUP_DIR</span><span class="si">}</span><span class="s2">/compose.backup&quot;</span>

<span class="c1"># Verify backup integrity</span>
<span class="nb">test</span><span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BACKUP_DIR</span><span class="si">}</span><span class="s2">/database.sql&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Database backup failed&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="o">}</span>
<span class="nb">test</span><span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BACKUP_DIR</span><span class="si">}</span><span class="s2">/storage.tar.gz&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Storage backup failed&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="o">}</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Environment Validation:</strong>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Check current version</span>
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>firefly-iii-application.application<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>php<span class="w"> </span>artisan<span class="w"> </span>--version

<span class="c1"># Verify system health</span>
curl<span class="w"> </span>-f<span class="w"> </span>http://localhost:8080/health<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;System unhealthy&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="o">}</span>

<span class="c1"># Check resource availability</span>
df<span class="w"> </span>-h<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;(/</span>$<span class="s2">|/var/lib/docker)&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;$5 &gt; &quot;80%&quot; {print &quot;Disk space warning: &quot; $0}&#39;</span>

<span class="c1"># Verify database connectivity</span>
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>firefly-iii-application.mariadb<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>mysql<span class="w"> </span>-u<span class="w"> </span>application<span class="w"> </span>-p<span class="s1">&#39;${DB_PASSWORD}&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="s2">&quot;SELECT COUNT(*) FROM transactions;&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Database check failed&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="o">}</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Change Documentation:</strong>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Review changelog for breaking changes</span>
curl<span class="w"> </span>-s<span class="w"> </span>https://api.github.com/repos/firefly-iii/firefly-iii/releases/latest<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>jq<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;.body&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>changelog.md

<span class="c1"># Check for configuration changes</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Review configuration requirements in changelog.md&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Update .env file if necessary&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Verify all required environment variables are set&quot;</span>
</code></pre></div></td></tr></table></div></p>
<h2 id="upgrade-execution">Upgrade Execution<a class="headerlink" href="#upgrade-execution" title="Permanent link">&para;</a></h2>
<p><strong>Docker Compose Upgrade:</strong>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Set target version</span>
<span class="nv">TARGET_VERSION</span><span class="o">=</span><span class="s2">&quot;6.1.18&quot;</span>

<span class="c1"># Update docker-compose.yml</span>
sed<span class="w"> </span>-i.backup<span class="w"> </span><span class="s2">&quot;s/tag: \&quot;.*\&quot;/tag: \&quot;</span><span class="si">${</span><span class="nv">TARGET_VERSION</span><span class="si">}</span><span class="s2">\&quot;/&quot;</span><span class="w"> </span>docker-compose.yml

<span class="c1"># Pull new images</span>
docker<span class="w"> </span>compose<span class="w"> </span>pull

<span class="c1"># Stop application (keep database running)</span>
docker<span class="w"> </span>compose<span class="w"> </span>stop<span class="w"> </span>firefly-iii-application.application<span class="w"> </span>firefly-iii-application.nginx

<span class="c1"># Start application with new version</span>
docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d<span class="w"> </span>firefly-iii-application.application<span class="w"> </span>firefly-iii-application.nginx

<span class="c1"># Wait for startup</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Waiting for application startup...&quot;</span>
timeout<span class="w"> </span><span class="m">300</span><span class="w"> </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;until curl -f http://localhost:8080/health; do sleep 5; done&#39;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Kubernetes Upgrade:</strong>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Update Helm values</span>
<span class="nv">TARGET_VERSION</span><span class="o">=</span><span class="s2">&quot;6.1.18&quot;</span>
yq<span class="w"> </span><span class="nb">eval</span><span class="w"> </span><span class="s2">&quot;.application.controllers.main.containers.app.image.tag = \&quot;</span><span class="si">${</span><span class="nv">TARGET_VERSION</span><span class="si">}</span><span class="s2">\&quot;&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-i<span class="w"> </span>ops/helm/application-application/values.yaml

<span class="c1"># Helm upgrade with rollback capability</span>
helm<span class="w"> </span>upgrade<span class="w"> </span>firefly-iii-application<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>ops/helm/application-application<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--namespace<span class="w"> </span>firefly-iii-application<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--wait<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--timeout<span class="w"> </span>10m<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--atomic

<span class="c1"># Verify deployment</span>
kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>firefly-iii-application
kubectl<span class="w"> </span>logs<span class="w"> </span>-n<span class="w"> </span>firefly-iii-application<span class="w"> </span>deployment/firefly-iii-application
</code></pre></div></td></tr></table></div></p>
<p><strong>Database Migrations:</strong>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Migrations run automatically on startup, but can be run manually</span>
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>firefly-iii-application.application<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>php<span class="w"> </span>artisan<span class="w"> </span>migrate<span class="w"> </span>--force

<span class="c1"># Check migration status</span>
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>firefly-iii-application.application<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>php<span class="w"> </span>artisan<span class="w"> </span>migrate:status
</code></pre></div></td></tr></table></div></p>
<h2 id="rollback-procedures">Rollback Procedures<a class="headerlink" href="#rollback-procedures" title="Permanent link">&para;</a></h2>
<p><strong>Immediate Rollback (Docker Compose):</strong>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Restore previous version</span>
<span class="nv">PREVIOUS_VERSION</span><span class="o">=</span><span class="s2">&quot;6.1.17&quot;</span><span class="w">  </span><span class="c1"># Set to known good version</span>

<span class="c1"># Stop current version</span>
docker<span class="w"> </span>compose<span class="w"> </span>down

<span class="c1"># Restore configuration</span>
cp<span class="w"> </span>docker-compose.yml.backup<span class="w"> </span>docker-compose.yml
cp<span class="w"> </span>.env.backup<span class="w"> </span>.env

<span class="c1"># Update to previous version</span>
sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/tag: \&quot;.*\&quot;/tag: \&quot;</span><span class="si">${</span><span class="nv">PREVIOUS_VERSION</span><span class="si">}</span><span class="s2">\&quot;/&quot;</span><span class="w"> </span>docker-compose.yml

<span class="c1"># Restore database if needed</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RESTORE_DATABASE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="c1"># Stop all services</span>
<span class="w">  </span>docker<span class="w"> </span>compose<span class="w"> </span>down

<span class="w">  </span><span class="c1"># Restore database</span>
<span class="w">  </span>cat<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BACKUP_DIR</span><span class="si">}</span><span class="s2">/database.sql&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>firefly-iii-application.mariadb<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>mysql<span class="w"> </span>-u<span class="w"> </span>application<span class="w"> </span>-p<span class="s1">&#39;${DB_PASSWORD}&#39;</span><span class="w"> </span>application
<span class="k">fi</span>

<span class="c1"># Start previous version</span>
docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d

<span class="c1"># Verify rollback</span>
timeout<span class="w"> </span><span class="m">300</span><span class="w"> </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;until curl -f http://localhost:8080/health; do sleep 5; done&#39;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Kubernetes Rollback:</strong>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Helm rollback to previous release</span>
helm<span class="w"> </span>rollback<span class="w"> </span>firefly-iii-application<span class="w"> </span>-n<span class="w"> </span>firefly-iii-application

<span class="c1"># Or rollback to specific revision</span>
helm<span class="w"> </span><span class="nb">history</span><span class="w"> </span>firefly-iii-application<span class="w"> </span>-n<span class="w"> </span>firefly-iii-application
helm<span class="w"> </span>rollback<span class="w"> </span>firefly-iii-application<span class="w"> </span><span class="m">3</span><span class="w"> </span>-n<span class="w"> </span>firefly-iii-application

<span class="c1"># Verify rollback</span>
kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>firefly-iii-application
kubectl<span class="w"> </span>rollout<span class="w"> </span>status<span class="w"> </span>deployment/firefly-iii-application<span class="w"> </span>-n<span class="w"> </span>firefly-iii-application
</code></pre></div></td></tr></table></div></p>
<p><strong>Database Rollback:</strong>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Database rollback (destructive - use with caution)</span>
<span class="c1"># Only if database schema changes are incompatible</span>

<span class="c1"># Stop application</span>
docker<span class="w"> </span>compose<span class="w"> </span>stop<span class="w"> </span>firefly-iii-application.application

<span class="c1"># Restore database from backup</span>
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>firefly-iii-application.mariadb<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>mysql<span class="w"> </span>-u<span class="w"> </span>application<span class="w"> </span>-p<span class="s1">&#39;${DB_PASSWORD}&#39;</span><span class="w"> </span>application<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>&lt;<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BACKUP_DIR</span><span class="si">}</span><span class="s2">/database.sql&quot;</span>

<span class="c1"># Restore storage if needed</span>
docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>firefly-iii-application-application-storage-data:/target<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BACKUP_DIR</span><span class="si">}</span><span class="s2">&quot;</span>:/backup:ro<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>alpine:latest<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>tar<span class="w"> </span>xzf<span class="w"> </span>/backup/storage.tar.gz<span class="w"> </span>-C<span class="w"> </span>/target

<span class="c1"># Start application</span>
docker<span class="w"> </span>compose<span class="w"> </span>start<span class="w"> </span>firefly-iii-application.application
</code></pre></div></td></tr></table></div></p>
<h2 id="validation-testing">Validation &amp; Testing<a class="headerlink" href="#validation-testing" title="Permanent link">&para;</a></h2>
<p><strong>Post-Upgrade Validation:</strong>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Health check validation</span>
curl<span class="w"> </span>-f<span class="w"> </span>http://localhost:8080/health<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span><span class="s1">&#39;.status&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-q<span class="w"> </span><span class="s2">&quot;healthy&quot;</span>

<span class="c1"># Version verification</span>
<span class="nv">CURRENT_VERSION</span><span class="o">=</span><span class="k">$(</span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>firefly-iii-application.application<span class="w"> </span>php<span class="w"> </span>artisan<span class="w"> </span>--version<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-o<span class="w"> </span><span class="s1">&#39;v[0-9.]*&#39;</span><span class="k">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Current version: </span><span class="si">${</span><span class="nv">CURRENT_VERSION</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># Database integrity check</span>
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>firefly-iii-application.application<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>php<span class="w"> </span>artisan<span class="w"> </span>firefly-iii:verify

<span class="c1"># Basic functionality test</span>
curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8080/<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-q<span class="w"> </span><span class="s2">&quot;Firefly III&quot;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Functional Testing:</strong>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Test critical user journeys</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Testing login functionality...&quot;</span>
<span class="c1"># Add automated login test here</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Testing transaction creation...&quot;</span>
<span class="c1"># Add automated transaction test here</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Testing data export...&quot;</span>
<span class="c1"># Add automated export test here</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Testing import functionality...&quot;</span>
<span class="c1"># Add automated import test here</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Performance Validation:</strong>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Response time check</span>
<span class="nv">RESPONSE_TIME</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-o<span class="w"> </span>/dev/null<span class="w"> </span>-s<span class="w"> </span>-w<span class="w"> </span><span class="s1">&#39;%{time_total}&#39;</span><span class="w"> </span>http://localhost:8080/<span class="k">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Response time: </span><span class="si">${</span><span class="nv">RESPONSE_TIME</span><span class="si">}</span><span class="s2">s&quot;</span>

<span class="c1"># Memory usage check</span>
<span class="nv">MEMORY_USAGE</span><span class="o">=</span><span class="k">$(</span>docker<span class="w"> </span>stats<span class="w"> </span>--no-stream<span class="w"> </span>--format<span class="w"> </span><span class="s2">&quot;{.MemUsage}&quot;</span><span class="w"> </span>firefly-iii-application.application<span class="k">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Memory usage: </span><span class="si">${</span><span class="nv">MEMORY_USAGE</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># Database performance check</span>
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>firefly-iii-application.mariadb<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>mysql<span class="w"> </span>-u<span class="w"> </span>application<span class="w"> </span>-p<span class="s1">&#39;${DB_PASSWORD}&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="s2">&quot;SHOW GLOBAL STATUS LIKE &#39;Threads_connected&#39;;&quot;</span>
</code></pre></div></td></tr></table></div></p>
<h2 id="upgrade-checklist">Upgrade Checklist<a class="headerlink" href="#upgrade-checklist" title="Permanent link">&para;</a></h2>
<p><strong>Pre-Upgrade:</strong>
- [ ] Review changelog for breaking changes
- [ ] Create database backup
- [ ] Create storage backup
- [ ] Verify system health
- [ ] Schedule maintenance window
- [ ] Notify users of potential downtime</p>
<p><strong>During Upgrade:</strong>
- [ ] Update configuration files
- [ ] Pull new container images
- [ ] Stop application services
- [ ] Start services with new version
- [ ] Monitor startup logs
- [ ] Verify health checks pass</p>
<p><strong>Post-Upgrade:</strong>
- [ ] Validate version upgrade
- [ ] Test critical functionality
- [ ] Check performance metrics
- [ ] Verify all services healthy
- [ ] Document any issues encountered
- [ ] Notify users of completion</p>
<p><strong>Rollback (if needed):</strong>
- [ ] Stop current version
- [ ] Restore previous configuration
- [ ] Restore database if necessary
- [ ] Start previous version
- [ ] Verify rollback successful
- [ ] Document rollback reason</p>
<h2 id="emergency-procedures">Emergency Procedures<a class="headerlink" href="#emergency-procedures" title="Permanent link">&para;</a></h2>
<p><strong>Critical Upgrade Failure:</strong>
1. Immediately stop the application
2. Restore from backup
3. Start previous version
4. Verify system health
5. Notify stakeholders
6. Investigate root cause</p>
<p><strong>Data Corruption Detection:</strong>
1. Stop application immediately
2. Do not restart until investigation complete
3. Restore from most recent clean backup
4. Document corruption details
5. Contact support if needed</p>
<h2 id="sources">Sources<a class="headerlink" href="#sources" title="Permanent link">&para;</a></h2>
<ul>
<li>"Firefly III Upgrade Guide" — <a href="https://docs.firefly-iii.org/how-to/firefly-iii/upgrade/">https://docs.firefly-iii.org/how-to/firefly-iii/upgrade/</a> — retrieved 2025-01-09</li>
<li>"Firefly III Installation Guide" — <a href="https://docs.firefly-iii.org/how-to/firefly-iii/installation/self-hosted/">https://docs.firefly-iii.org/how-to/firefly-iii/installation/self-hosted/</a> — retrieved 2025-01-09</li>
</ul>
<!-- ai-docs-metadata
{"last_audit":"2025-01-09","fingerprints":{"sources":{"https://docs.firefly-iii.org/how-to/firefly-iii/upgrade/":"","https://docs.firefly-iii.org/how-to/firefly-iii/installation/self-hosted/":""},"sections":{"upgrades-rollback":""}}}
-->







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../observability/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Observability">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Observability
              </div>
            </div>
          </a>
        
        
          
          <a href="../troubleshooting/startup/" class="md-footer__link md-footer__link--next" aria-label="Next: Startup">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Startup
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      webgrip © 2013 - 2025 Building Better Developers  - <a href="#__consent">Change cookie settings</a>

    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/webgrip" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            





<h4>Cookie consent</h4>
<p>We use cookies to gather insights into our site's traffic and to ensure you're able to leave feedback. If you do not wish to leave feedback or be tracked, feel free to reject the cookies :)
Thank you for visiting!</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          Github
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
    
    
      <button type="reset" class="md-button md-button--primary">Reject</button>
    
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "search.share", "navigation.instant", "navigation.instant.progress", "navigation.instant.preview", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.tabs.sections", "navigation.tabs.expand", "navigation.prune", "toc.follow", "toc.integrate", "navigation.top", "navigation.footer", "content.action.edit"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../../javascripts/feedback.js"></script>
      
        <script src="../../search/main.js"></script>
      
    
  </body>
</html>